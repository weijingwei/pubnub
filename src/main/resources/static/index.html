<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>PubNub</title>
<script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.21.7.js"></script>
<script type="text/javascript">
	var pubnubDemo = new PubNub({
		publishKey : 'pub-c-d1e3d8b6-968f-44bf-b37d-846124cb264c',
		subscribeKey : 'sub-c-6fe595d2-aea8-11e9-9c97-16f61f10341e',
		secure : true,
		secretKey : 'sec-c-YzlmMGUwMjYtZDA1MC00N2ZmLWE3OWQtODQwZDQzYzZkMzdh'
	});

	var channels = [ 'test FED channel', '5d9021d25731a1218728273b' ];

	pubnubDemo
			.addListener({
				message : function(message) {
					console.log(message);
					document.getElementById("messages").innerHTML = ("<pre style='white-space:pre-wrap; word-wrap:break-word'>"
							+ JSON.stringify(message, null, 2) + "</pre><hr>" + document
							.getElementById("messages").innerHTML);
					if (message.message.actionType === "DASHBOARD_ADD") {
						var dashboard = JSON.parse(message.message.currentData);
						channels.push(dashboard.id);
						pubnubDemo.subscribe({
							channels : channels
						});
					}
				}
			});

	pubnubDemo.subscribe({
		channels : channels
	});

	function sendMessage() {
		var messages = document.getElementById("message").value;
		pubnubDemo.publish({
			message : {
				"content" : messages
			},
			channel : 'test FED channel'
		});
	}
</script>
</head>
<body>
	<textarea id="message" style="width: 600px; height: 200px;"></textarea>
	<button onclick="sendMessage()">send</button>
	<hr>
	<div id="messages"></div>
</body>
</html>